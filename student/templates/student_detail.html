{% extends 'base.html'%}
{% block content %}

<style>
    .row {
        border: 3px solid black;

    }

    .col {
        box-sizing: border-box;

        margin: 15px;
    }
</style>

<br>

<div class="container">
    <div class='row'>
        <div class="col" id="check" style="border-right:1px solid black;">
            <form method="POST">
                {% csrf_token %}
                <p>출결 로그 조회</p>
                {{form}}
                <button type='submit' class="btn btn-outline-primary">선택</button>

                <p id='test'> </p>
            </form>
        </div>
        <div class="col" id="time">
            안녕
        </div>
    </div>
</div>

<br>

<div class="container">
    <table class="table table-striped">
        <thead>    
            <tr>
                <th>번호</th>
                <th>학번</th>
                <th>출석 일자</th>
                <script type="text/javascript">
                var k1 = "{{posts.0.result}}";
                var k2 = k1.replace(/&quot;/g, "\"");
                var k3 = JSON.parse(k2); 
                var num = 1;
                for(key in k3) {
                    document.write("<th>" + num++ + "차 출석" + "</th>");
                    }
                </script>

                <script type="text/javascript">
                    var k1 = "{{attends.result}}";
                    var k2 = k1.replace(/&quot;/g, "\"");
                    var k3 = JSON.parse(k2); 
                    var num = 1;
                    for(key in k3) {
                        document.write("<th>" + num++ + "차 출석"+"</th>");
                        }
                </script>
            </tr>
            
        </thead>
        <tbody>
            {% for attend in posts %}
            <tr>
                <td>{{attend.id}}</td>
                <td>{{attend.username}}</td>
                <td>{{attend.time}}</td>
                <script type="text/javascript">
                var k1 = "{{attend.result}}";
                var k2 = k1.replace(/&quot;/g, "\"");
                var k3 = JSON.parse(k2); 
                for(key in k3) {
                    switch(k3[key]){
                        case "ATTEND":
                        document.write("<td>"+"출석"+"</td>");
                        break;
                        case "LATE":
                        document.write("<td>"+"지각"+"</td>");
                        break;
                        case "ABSENT":
                        document.write("<td>"+"결석"+"</td>");
                        break;
                    }
                }
                </script>
            </tr>
            {%endfor%}
            <tr>
                <td>{{attends.id}}</td>
                <td>{{attends.username}}</td>
                <td>{{attends.time}}</td>
                <script type="text/javascript">
                    var k1 = "{{attends.result}}";
                    var k2 = k1.replace(/&quot;/g, "\"");
                    var k3 = JSON.parse(k2); 
                    for(key in k3) {
                        switch(k3[key]){
                            case "ATTEND":
                            document.write("<td>"+"출석"+"</td>");
                            break;
                            case "LATE":
                            document.write("<td>"+"지각"+"</td>");
                            break;
                            case "ABSENT":
                            document.write("<td>"+"결석"+"</td>");
                            break;
                        }
                    }
                </script>
            </tr>
        </tbody>
    </table>
    <hr>
    <div class="container">
        <br><br>
        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center">
                <a class="page-link" href="?page=1">처음</a>
                {%if post.has_previous%}
                <a class="page-link" href="?page={{post.previous_page_number}}">이전</a>
                {% else %}
                <a class="page-link" href="#">이전</a>
                {%endif%}
                {% for page in page_range%}
                {%if page == post.number%}
                <li class="page-item active" aria-current="page" {% if page == post.number %}class="active"
                    {% endif %}>
                    <a class="page-link" href="?page={{page}}">{{page}}<span class="sr-only">(current)</span></a>
                </li>
                {%else%}
                <li class="page-item" {% if page == post.number %}class="active" {% endif %}>
                    <a class="page-link" href="?page={{page}}">{{page}}</a>
                </li>
                {%endif%}

                {% endfor %}
                {%if post.has_next%}
                <a class="page-link" href="?page={{post.next_page_number}}">다음</a>
                {%else%}
                <a class="page-link" href="#">다음</a>
                {%endif%}
                <a class="page-link" href="?page={{post.paginator.num_pages}}">끝</a>
            </ul>
        </nav>

    </div>
</div>
{% endblock %}